(window["webpackJsonpsound-board"]=window["webpackJsonpsound-board"]||[]).push([[0],{11:function(e,t,n){e.exports=n(20)},18:function(e,t,n){},19:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),o=n(7),a=n.n(o),l=n(2),s=n(4),i=n(5),u=n(8),f=n(9),h=n(3),d=n.n(h),p=16,b=["Synth","AMSynth","DuoSynth"],m=n(1),v=[],w=new d.a.Meter("level"),y=new d.a.Analyser("fft",64),g=new d.a.Analyser("waveform",256),k=function(){function e(t){Object(u.a)(this,e),this.loopCallback=function(){},this.initInstruments(t),this.releaseAll=this.releaseAll.bind(this)}return Object(f.a)(e,[{key:"createLoop",value:function(e){this.loopCallback=e,new d.a.Loop(this.loopCallback,"".concat(p,"n")).start(0)}},{key:"stopLoop",value:function(){d.a.Transport.stop(),this.loopCallback=function(){}}},{key:"attack",value:function(e,t){var n;if(v.forEach(function(e){e(t)}),this[e]){for(var r=arguments.length,c=new Array(r>2?r-2:0),o=2;o<r;o++)c[o-2]=arguments[o];(n=this[e]).triggerAttack.apply(n,[t].concat(c))}else console.error("Unable to find synth",e)}},{key:"release",value:function(e){var t;if(this[e]){for(var n=arguments.length,r=new Array(n>1?n-1:0),c=1;c<n;c++)r[c-1]=arguments[c];(t=this[e]).triggerRelease.apply(t,r)}else console.error("Unable to find synth",e)}},{key:"releaseAll",value:function(){var e=this;b.forEach(function(t){e[t].releaseAll()})}},{key:"attackRelease",value:function(e,t){var n;if(v.forEach(function(e){e(t)}),this[e]){for(var r=arguments.length,c=new Array(r>2?r-2:0),o=2;o<r;o++)c[o-2]=arguments[o];(n=this[e]).triggerAttackRelease.apply(n,[t].concat(c))}else console.error("Unable to find synth",e)}},{key:"initInstruments",value:function(e){var t=this,n=e;e>6&&(n=6),b.forEach(function(e){t.setInstrument(n,e)})}},{key:"setInstrument",value:function(e,t){this[t]=new d.a.PolySynth(e,d.a[t]).connect(w).fan(y,g).toMaster()}}],[{key:"startLoop",value:function(){d.a.Transport.start()}}]),e}();function O(e){var t=Object(r.useRef)();return Object(r.useEffect)(function(){t.current&&t.current.instrument.releaseAll(),t.current=new k(e)},[e]),t}function E(e){var t=e.highlight,n=e.clicked,o=e.notes,a=e.time,l=e.playNote,s=e.synthName,i=e.clicked&&!e.note,u=i?"red":"gray";Object(r.useEffect)(function(){t&&n&&o.length&&l(s,o,"".concat(a,"n"))},[t,n,o,a,l,s]);var f=700;e.highlight&&e.clicked?f=300:(e.highlight||e.clicked)&&(f=400),i&&(f+=200);var h="mx-1 w-full h-full rounded cursor-pointer flex items-center justify-center bg-".concat(u,"-").concat(f);return c.a.createElement("div",{style:{transition:"background-color 400ms ease",textAlign:"center"},className:h,key:"button-".concat(e.row,"-").concat(e.column),onClick:e.onClick},e.notes.join(","))}function j(e){return c.a.createElement("select",{onChange:function(t){e.onChange(t.target.value)},className:"border h-10 mx-2 flex border-gray-400 hover:border-gray-500 rounded shadow leading-tight focus:outline-none focus:shadow-outline",value:e.value},e.options.map(function(e){return c.a.createElement("option",{key:e},e)}))}function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function N(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}var R=c.a.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),x=c.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),A=function(e){var t=e.svgRef,n=e.title,r=N(e,["svgRef","title"]);return c.a.createElement("svg",C({width:24,height:24,viewBox:"0 0 24 24",ref:t},r),c.a.createElement("title",null,n),R,x)},S=c.a.forwardRef(function(e,t){return c.a.createElement(A,C({svgRef:t},e))});n.p;function L(e){for(var t=e.maxSize,n=e.step,o=e.onClick,a=e.rowData,s=Object(r.useState)(8),i=Object(l.a)(s,2),u=i[0],f=i[1],h=O(t),d=Object(r.useCallback)(function(){var e;h.current&&(e=h.current).attackRelease.apply(e,arguments)},[h]),b=[],m=Math.floor(n/Math.floor(p/u)),v=function(e){b.push(c.a.createElement(E,Object.assign({},a[e],{key:"button-".concat(e),highlight:m===e,time:u,playNote:d,onClick:function(){o(e)}})))},w=0;w<u;w++)v(w);return c.a.createElement("div",{className:"flex w-full h-full m-2"},c.a.createElement("div",{className:"flex w-full"},b),c.a.createElement("div",{className:"flex"},c.a.createElement(j,{options:[4,8,16],value:u,onChange:function(e){f(e)}}),c.a.createElement("div",{className:"mx-1 w-full h-full rounded cursor-pointer flex items-center justify-center bg-white",onClick:e.onDelete},c.a.createElement(S,null))))}var P=n(10);n(18);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(n,!0).forEach(function(t){Object(i.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var z=[{color:"white",note:"C4",pressed:!1,shortcut:"a"},{color:"black",note:"C#4",pressed:!1,shortcut:"w"},{color:"white",note:"D4",pressed:!1,shortcut:"s"},{color:"black",note:"D#4",pressed:!1,shortcut:"e"},{color:"white",note:"E4",pressed:!1,shortcut:"d"},{color:"white",note:"F4",pressed:!1,shortcut:"f"},{color:"black",note:"F#4",pressed:!1,shortcut:"t"},{color:"white",note:"G4",pressed:!1,shortcut:"g"},{color:"black",note:"G#4",pressed:!1,shortcut:"y"},{color:"white",note:"A4",pressed:!1,shortcut:"h"},{color:"black",note:"A#4",pressed:!1,shortcut:"u"},{color:"white",note:"B4",pressed:!1,shortcut:"j"},{color:"white",note:"C5",pressed:!1,shortcut:"A"},{color:"black",note:"C#5",pressed:!1,shortcut:"W"},{color:"white",note:"D5",pressed:!1,shortcut:"S"},{color:"black",note:"D#5",pressed:!1,shortcut:"E"},{color:"white",note:"E5",pressed:!1,shortcut:"D"},{color:"white",note:"F5",pressed:!1,shortcut:"F"},{color:"black",note:"F#5",pressed:!1,shortcut:"T"},{color:"white",note:"G5",pressed:!1,shortcut:"G"},{color:"black",note:"G#5",pressed:!1,shortcut:"Y"},{color:"white",note:"A5",pressed:!1,shortcut:"H"},{color:"black",note:"A#5",pressed:!1,shortcut:"U"},{color:"white",note:"B5",pressed:!1,shortcut:"J"}],F={white:"h-40 z-0 key-white",black:"h-20 z-10 key-black"};function H(e){return Object(r.useEffect)(function(){var t=function(t){t.key===e.shortcut&&e.onAttack()},n=function(t){t.key===e.shortcut&&e.onRelease()};return window.addEventListener("keydown",t),window.addEventListener("keyup",n),function(){window.removeEventListener("keydown",t),window.removeEventListener("keyup",n)}},[e]),c.a.createElement("div",{className:Object(P.a)("border-2 border-gray w-8 -ml-4",e.className,{"bg-gray-100":"white"===e.color&&!e.pressed},{"bg-gray-800":"black"===e.color&&!e.pressed},{"bg-gray-200":"white"===e.color&&e.pressed},{"bg-gray-700":"black"===e.color&&e.pressed},F[e.color]),onMouseDown:e.onAttack,onMouseUp:e.onRelease,onMouseLeave:e.onRelease,onTouchCancel:e.onRelease,onTouchEnd:e.onRelease,role:"button"})}function I(e){var t=e.onClick,n=e.synthName,o=Object(r.useState)([].concat(z)),a=Object(l.a)(o,2),i=a[0],u=a[1],f=O(Object.keys(z).length);Object(r.useEffect)(function(){var e=function(e){var t=!1;if("Shift"===e.key){var n=i.map(function(e,n){return e.pressed?(t=!0,f.current.release(e.note),M({},e,{pressed:!1})):e});t&&u(n)}};return window.addEventListener("keydown",e),window.addEventListener("keyup",e),function(){window.removeEventListener("keydown",e),window.removeEventListener("keyup",e)}},[i,f]);return Object(r.useEffect)(function(){var e=function(){f.current&&(u([].concat(z)),f.current.releaseAll())};return window.addEventListener("blur",e),function(){window.removeEventListener("blur",e)}},[f]),c.a.createElement("div",{className:"flex justify-center w-full p-4"},i.map(function(e,r){return c.a.createElement(H,Object.assign({key:r,hightlight:!1,onAttack:function(){if(!i[r].pressed){var e=Object(s.a)(i);e[r]=M({},e[r],{pressed:!0}),u(e),function(e){var r=e.reduce(function(e,t){return t.pressed?e.concat(t.note):e},[]);r.length>0&&(t(r),f.current.attack(n,r))}(e)}},onRelease:function(){if(i[r].pressed){var t=Object(s.a)(i);t[r].pressed=!1,t[r]=M({},t[r],{pressed:!1}),u(t),f.current.release(n,e.note)}}},e))}))}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var G=function(e){return[new Array(e).fill(0).map(function(){return{notes:[],synthName:null,clicked:!1}})]};function T(e){var t=e.maxSize,n=e.synthName,o=Object(r.useState)(G(t)),a=Object(l.a)(o,2),u=a[0],f=a[1];Object(r.useEffect)(function(){var n=function(){var e=Object(m.map)(u,function(e){return Object(m.map)(e,function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(n,!0).forEach(function(t){Object(i.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{notes:[],clicked:!1})})});f(e)},r=function(){f(u.concat(G(t)))};return e.emitter.addEventListener("clear",n),e.emitter.addEventListener("addRow",r),function(){e.emitter.removeEventListener("clear",n),e.emitter.removeEventListener("addRow",r)}},[e.emitter,e.size,u,t]);var h=Object(r.useCallback)(function(e){u.forEach(function(t,r){t.forEach(function(t,c){if(t.clicked&&!t.notes.length){var o=Object(s.a)(u);o[r][c].notes=e,o[r][c].synthName=n,f(o)}})})},[u,n]);return c.a.createElement("div",null,c.a.createElement("div",{className:"flex  w-full"},c.a.createElement("div",{className:"flex h-auto m-2 w-full flex-col"},u.map(function(n,r){return c.a.createElement(L,{rowData:n,maxSize:t,step:e.step,key:r,onClick:function(e){var t=Object(s.a)(u);t[r][e].clicked=!t[r][e].clicked,t[r][e].notes=[],f(t)},onDelete:function(){var e=Object(s.a)(u);e.splice(r,1),f(e)}})}))),c.a.createElement("div",{className:"p-4 w-full justify-center"},c.a.createElement(I,{onClick:h,synthName:n})))}function U(e,t,n,r,c){return 0===arguments.length||e!=e||t!=t||n!=n||r!=r||c!=c?NaN:e===1/0||e===-1/0?e:(e-t)*(c-r)/(n-t)+r}function W(e){var t=Object(r.useRef)(),n=Object(r.useRef)(),o=Object(r.useCallback)(function(){requestAnimationFrame(o);var e=y.getValue(),r=t.current.width,c=t.current.height;n.current.clearRect(0,0,r,c),n.current.fillStyle="black",e.forEach(function(t,o){var a=U(o,0,e.length,0,r),l=Object(m.clamp)(U(t,-100,0,0,c),0,c);n.current.fillRect(a,c/2-l/2,2,l),n.current.fill()}),n.current.strokeStyle="white",n.current.stroke()},[]);return Object(r.useEffect)(function(){o()},[o]),c.a.createElement("canvas",{className:"w-24 h-10 border-2 border-gray-600 rounded",ref:function(e){null!==e&&(t.current=e,e.width=2*e.clientWidth,e.height=2*e.clientHeight,n.current=e.getContext("2d"))}},"waveform of current playing audio")}var V=5;function J(e){var t=Object(r.useRef)(),n=Object(r.useRef)(),o=Object(r.useCallback)(function(){requestAnimationFrame(o);var e=w.getValue(),r=t.current.width,c=t.current.height;if(e>=0){n.current.clearRect(0,0,r,c),n.current.fillStyle="black";var a=e*c;n.current.fillRect(0,c-a-V,r,V),n.current.fill(),e>0&&(n.current.fillStyle="gray",n.current.fillRect(0,c-a,r,c),n.current.fill())}},[]);return Object(r.useEffect)(function(){o()},[o]),c.a.createElement("canvas",{className:"w-4 h-10 m-2 border-2 border-gray-600 rounded",ref:function(e){null!==e&&(t.current=e,e.width=2*e.clientWidth,e.height=2*e.clientHeight,n.current=e.getContext("2d"))}},"meter of current playing audio")}n(19);var q=-1,Y=p,$="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded m-2";var K=function(){var e=Object(r.useState)(q),t=Object(l.a)(e,2),n=t[0],o=t[1],a=Object(r.useState)(b[0]),s=Object(l.a)(a,2),i=s[0],u=s[1],f=Object(r.useRef)(n),h=Object(r.useRef)({clear:[],addRow:[]}),d=Object(r.useRef)(),p={addEventListener:function(e,t){h.current[e]||(h.current[e]=[]),h.current[e].push(t)},removeEventListener:function(e,t){h.current[e]=Object(m.without)(h.current[e],t)}},v=function(){var e;e=f.current+1<Y?f.current+1:0,f.current=e,o(f.current)};return Object(r.useEffect)(function(){d.current=new k(1),d.current.createLoop(v)},[]),c.a.createElement("div",{className:"flex flex-col h-screen items-center justify-center bg-gray-200"},c.a.createElement("div",{className:"flex items-center justify-between p-2"},c.a.createElement(J,null),c.a.createElement(W,null),c.a.createElement(J,null)),c.a.createElement("div",{className:"flex items-center justify-between p-2"},c.a.createElement("button",{className:$,onClick:function(){d.current.constructor.startLoop()}},"Start"),c.a.createElement("button",{className:$,onClick:function(){d.current.stopLoop(),f.current=q,o(q)}},"Stop"),c.a.createElement("button",{className:$,onClick:function(){h.current.clear.forEach(function(e){return e()})}},"Clear"),c.a.createElement("button",{className:$,onClick:function(){h.current.addRow.forEach(function(e){return e()})}},"Add row"),c.a.createElement(j,{options:b,value:i,onChange:function(e){u(e)}})),c.a.createElement(T,{maxSize:Y,step:n,emitter:p,synthName:i}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(c.a.createElement(K,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[11,1,2]]]);
//# sourceMappingURL=main.83f18051.chunk.js.map