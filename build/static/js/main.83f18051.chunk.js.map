{"version":3,"sources":["constants.js","utils/Player.js","hooks/usePlayer.js","components/Button.js","components/Dropdown.js","icons/delete.svg","components/Row.js","components/Keyboard.js","components/Board.js","utils/index.js","components/FFT.js","components/Meter.js","App.js","serviceWorker.js","index.js"],"names":["maxTimeCount","synthOptions","evtCallbacks","meter","Tone","Meter","fft","Analyser","waveform","Player","count","this","loopCallback","initInstruments","releaseAll","bind","fn","Loop","start","Transport","stop","synthName","notes","forEach","cb","rest","triggerAttack","console","error","triggerRelease","synthConstructorName","triggerAttackRelease","synthSize","setInstrument","newInstrumentConstructor","PolySynth","connect","fan","toMaster","usePlayer","player","useRef","useEffect","current","instrument","Button","props","highlight","clicked","time","playNote","recording","note","color","length","colorWeight","classes","style","transition","textAlign","className","key","row","column","onClick","join","onChange","e","target","value","options","map","val","_extends","Object","assign","i","arguments","source","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref2","createElement","d","_ref3","fill","_ref","svgRef","title","width","height","viewBox","ref","ForwardRef","forwardRef","Row","maxSize","step","rowData","useState","size","setSize","useCallback","attackRelease","els","relativeStep","Math","floor","colIdx","push","onDelete","initialKeyState","pressed","shortcut","white","black","Key","downListener","onAttack","upListener","onRelease","window","addEventListener","removeEventListener","clsx","onMouseDown","onMouseUp","onMouseLeave","onTouchCancel","onTouchEnd","role","Keyboard","keyState","setKeyState","releaseLastKeyIfShift","sawChange","clone","idx","release","blurListener","state","hightlight","board","reduce","memo","concat","attack","playPressedNotes","getEmptyRow","Array","Board","setBoard","clear","addRow","emitter","lookForEvt","rowIdx","el","splice","scale","x","inLow","inHigh","outLow","outHigh","NaN","Infinity","FFT","canvas","context","loop","requestAnimationFrame","getValue","clearRect","fillStyle","v","barHeight","clamp","fillRect","strokeStyle","stroke","node","clientWidth","clientHeight","getContext","meterValue","positionY","initialStep","buttonClasses","App","setStep","setSynthName","stepContainer","callbackContainer","loopPlayer","event","without","tick","newVal","createLoop","constructor","startLoop","stopLoop","Boolean","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.83f18051.chunk.js","sourcesContent":["export const maxTimeCount = 16;\nexport const maxPolySynthSize = 6;\nexport const synthOptions = [\"Synth\", \"AMSynth\", \"DuoSynth\"];\n","import Tone from \"tone\";\nimport { maxTimeCount, maxPolySynthSize, synthOptions } from \"../constants\";\nimport { without } from \"lodash\";\n\nlet evtCallbacks = [];\n\nexport const addNoteListener = cb => {\n  evtCallbacks.push(cb);\n};\nexport const removeNoteListener = cb => {\n  evtCallbacks = without(evtCallbacks, cb);\n};\n\nexport const meter = new Tone.Meter(\"level\");\nexport const fft = new Tone.Analyser(\"fft\", 64);\nexport const waveform = new Tone.Analyser(\"waveform\", 256);\n\nexport default class Player {\n  constructor(count) {\n    this.loopCallback = () => {};\n    this.initInstruments(count);\n    this.releaseAll = this.releaseAll.bind(this);\n  }\n  createLoop(fn) {\n    this.loopCallback = fn;\n    new Tone.Loop(this.loopCallback, `${maxTimeCount}n`).start(0);\n  }\n\n  static startLoop() {\n    Tone.Transport.start();\n  }\n\n  stopLoop() {\n    Tone.Transport.stop();\n    this.loopCallback = () => {};\n  }\n\n  attack(synthName, notes, ...rest) {\n    evtCallbacks.forEach(cb => {\n      cb(notes);\n    });\n    if (!this[synthName]) {\n      console.error(\"Unable to find synth\", synthName);\n      return;\n    }\n    this[synthName].triggerAttack(notes, ...rest);\n  }\n\n  release(synthName, ...rest) {\n    if (!this[synthName]) {\n      console.error(\"Unable to find synth\", synthName);\n      return;\n    }\n    this[synthName].triggerRelease(...rest);\n  }\n\n  releaseAll() {\n    synthOptions.forEach(synthConstructorName => {\n      this[synthConstructorName].releaseAll();\n    });\n  }\n\n  attackRelease(synthName, notes, ...rest) {\n    evtCallbacks.forEach(cb => {\n      cb(notes);\n    });\n    if (!this[synthName]) {\n      console.error(\"Unable to find synth\", synthName);\n      return;\n    }\n    this[synthName].triggerAttackRelease(notes, ...rest);\n  }\n\n  initInstruments(count) {\n    let synthSize = count;\n    if (count > maxPolySynthSize) {\n      synthSize = maxPolySynthSize;\n    }\n    synthOptions.forEach(synthConstructorName => {\n      this.setInstrument(synthSize, synthConstructorName);\n    });\n  }\n\n  setInstrument(synthSize, newInstrumentConstructor) {\n    this[newInstrumentConstructor] = new Tone.PolySynth(\n      synthSize,\n      Tone[newInstrumentConstructor]\n    )\n      .connect(meter)\n      .fan(fft, waveform)\n      .toMaster();\n  }\n}\n","import { useRef, useEffect } from \"react\";\nimport Player from \"../utils/Player\";\n\nexport default function usePlayer(count) {\n  const player = useRef();\n  useEffect(() => {\n    if (player.current) {\n      player.current.instrument.releaseAll();\n    }\n    player.current = new Player(count);\n  }, [count]);\n\n  return player;\n}\n","import React, { useEffect } from \"react\";\n\nexport default function Button(props) {\n  const { highlight, clicked, notes, time, playNote, synthName } = props;\n  const recording = props.clicked && !props.note;\n  const color = recording ? \"red\" : \"gray\";\n  useEffect(() => {\n    if (highlight && clicked && notes.length) {\n      playNote(synthName, notes, `${time}n`);\n    }\n  }, [highlight, clicked, notes, time, playNote, synthName]);\n\n  let colorWeight = 700;\n  if (props.highlight && props.clicked) {\n    colorWeight = 300;\n  } else if (props.highlight || props.clicked) {\n    colorWeight = 400;\n  }\n  if (recording) {\n    colorWeight += 200;\n  }\n  let classes = `mx-1 w-full h-full rounded cursor-pointer flex items-center justify-center bg-${color}-${colorWeight}`;\n  return (\n    <div\n      style={{ transition: \"background-color 400ms ease\", textAlign: \"center\" }}\n      className={classes}\n      key={`button-${props.row}-${props.column}`}\n      onClick={props.onClick}\n    >\n      {props.notes.join(\",\")}\n    </div>\n  );\n}\n","import React from \"react\";\n\nexport default function Button(props) {\n  return (\n    <select\n      onChange={e => {\n        props.onChange(e.target.value);\n      }}\n      className=\"border h-10 mx-2 flex border-gray-400 hover:border-gray-500 rounded shadow leading-tight focus:outline-none focus:shadow-outline\"\n      value={props.value}\n    >\n      {props.options.map(val => (\n        <option key={val}>{val}</option>\n      ))}\n    </select>\n  );\n}\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z\"\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M0 0h24v24H0z\",\n  fill: \"none\"\n});\n\nvar SvgDelete = function SvgDelete(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    ref: svgRef\n  }, props), React.createElement(\"title\", null, title), _ref2, _ref3);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgDelete, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/delete.d36bd4a7.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useState, useCallback } from \"react\";\nimport usePlayer from \"../hooks/usePlayer\";\nimport Button from \"./Button\";\nimport Dropdown from \"./Dropdown\";\nimport { maxTimeCount } from \"../constants\";\nimport { ReactComponent as DeleteIcon } from \"../icons/delete.svg\";\n\nexport default function Row(props) {\n  const { maxSize, step, onClick, rowData } = props;\n  const [size, setSize] = useState(8);\n\n  const player = usePlayer(maxSize);\n  const playNote = useCallback(\n    (...args) => {\n      if (player.current) {\n        player.current.attackRelease(...args);\n      }\n    },\n    [player]\n  );\n\n  let els = [];\n  const relativeStep = Math.floor(step / Math.floor(maxTimeCount / size));\n  for (let colIdx = 0; colIdx < size; colIdx++) {\n    els.push(\n      <Button\n        {...rowData[colIdx]}\n        key={`button-${colIdx}`}\n        highlight={relativeStep === colIdx}\n        time={size}\n        playNote={playNote}\n        onClick={() => {\n          onClick(colIdx);\n        }}\n      />\n    );\n  }\n  return (\n    <div className=\"flex w-full h-full m-2\">\n      <div className=\"flex w-full\">{els}</div>\n      <div className=\"flex\">\n        <Dropdown\n          options={[4, 8, 16]}\n          value={size}\n          onChange={val => {\n            setSize(val);\n          }}\n        />\n        <div\n          className=\"mx-1 w-full h-full rounded cursor-pointer flex items-center justify-center bg-white\"\n          onClick={props.onDelete}\n        >\n          <DeleteIcon />\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\nimport clsx from \"clsx\";\nimport \"./Keyboard.css\";\nimport usePlayer from \"../hooks/usePlayer\";\n\nconst initialKeyState = [\n  { color: \"white\", note: \"C4\", pressed: false, shortcut: \"a\" },\n  { color: \"black\", note: \"C#4\", pressed: false, shortcut: \"w\" },\n  { color: \"white\", note: \"D4\", pressed: false, shortcut: \"s\" },\n  { color: \"black\", note: \"D#4\", pressed: false, shortcut: \"e\" },\n  { color: \"white\", note: \"E4\", pressed: false, shortcut: \"d\" },\n  { color: \"white\", note: \"F4\", pressed: false, shortcut: \"f\" },\n  { color: \"black\", note: \"F#4\", pressed: false, shortcut: \"t\" },\n  { color: \"white\", note: \"G4\", pressed: false, shortcut: \"g\" },\n  { color: \"black\", note: \"G#4\", pressed: false, shortcut: \"y\" },\n  { color: \"white\", note: \"A4\", pressed: false, shortcut: \"h\" },\n  { color: \"black\", note: \"A#4\", pressed: false, shortcut: \"u\" },\n  { color: \"white\", note: \"B4\", pressed: false, shortcut: \"j\" },\n  { color: \"white\", note: \"C5\", pressed: false, shortcut: \"A\" },\n  { color: \"black\", note: \"C#5\", pressed: false, shortcut: \"W\" },\n  { color: \"white\", note: \"D5\", pressed: false, shortcut: \"S\" },\n  { color: \"black\", note: \"D#5\", pressed: false, shortcut: \"E\" },\n  { color: \"white\", note: \"E5\", pressed: false, shortcut: \"D\" },\n  { color: \"white\", note: \"F5\", pressed: false, shortcut: \"F\" },\n  { color: \"black\", note: \"F#5\", pressed: false, shortcut: \"T\" },\n  { color: \"white\", note: \"G5\", pressed: false, shortcut: \"G\" },\n  { color: \"black\", note: \"G#5\", pressed: false, shortcut: \"Y\" },\n  { color: \"white\", note: \"A5\", pressed: false, shortcut: \"H\" },\n  { color: \"black\", note: \"A#5\", pressed: false, shortcut: \"U\" },\n  { color: \"white\", note: \"B5\", pressed: false, shortcut: \"J\" }\n];\n\nconst classes = {\n  white: \"h-40 z-0 key-white\",\n  black: \"h-20 z-10 key-black\"\n};\n\nfunction Key(props) {\n  useEffect(() => {\n    const downListener = e => {\n      if (e.key !== props.shortcut) return;\n      props.onAttack();\n    };\n    const upListener = e => {\n      if (e.key !== props.shortcut) return;\n      props.onRelease();\n    };\n\n    window.addEventListener(\"keydown\", downListener);\n    window.addEventListener(\"keyup\", upListener);\n    return () => {\n      window.removeEventListener(\"keydown\", downListener);\n      window.removeEventListener(\"keyup\", upListener);\n    };\n  }, [props]);\n\n  return (\n    <div\n      className={clsx(\n        \"border-2 border-gray w-8 -ml-4\",\n        props.className,\n        { \"bg-gray-100\": props.color === \"white\" && !props.pressed },\n        { \"bg-gray-800\": props.color === \"black\" && !props.pressed },\n        { \"bg-gray-200\": props.color === \"white\" && props.pressed },\n        { \"bg-gray-700\": props.color === \"black\" && props.pressed },\n        classes[props.color]\n      )}\n      onMouseDown={props.onAttack}\n      onMouseUp={props.onRelease}\n      onMouseLeave={props.onRelease}\n      onTouchCancel={props.onRelease}\n      onTouchEnd={props.onRelease}\n      role=\"button\"\n    />\n  );\n}\n\nexport default function Keyboard({ onClick, synthName }) {\n  const [keyState, setKeyState] = useState([...initialKeyState]);\n  const playerSize = Object.keys(initialKeyState).length;\n  const player = usePlayer(playerSize);\n\n  useEffect(() => {\n    const releaseLastKeyIfShift = e => {\n      let sawChange = false;\n      if (e.key === \"Shift\") {\n        const clone = keyState.map((val, idx) => {\n          if (val.pressed) {\n            sawChange = true;\n            player.current.release(val.note);\n            return { ...val, pressed: false };\n          }\n          return val;\n        });\n\n        if (sawChange) {\n          setKeyState(clone);\n        }\n      }\n    };\n\n    window.addEventListener(\"keydown\", releaseLastKeyIfShift);\n    window.addEventListener(\"keyup\", releaseLastKeyIfShift);\n    return () => {\n      window.removeEventListener(\"keydown\", releaseLastKeyIfShift);\n      window.removeEventListener(\"keyup\", releaseLastKeyIfShift);\n    };\n  }, [keyState, player]);\n\n  const playPressedNotes = board => {\n    const keys = board.reduce((memo, keyState) => {\n      if (keyState.pressed) {\n        return memo.concat(keyState.note);\n      }\n      return memo;\n    }, []);\n    if (keys.length > 0) {\n      onClick(keys);\n      if (process.env.NODE_ENV === \"DEBUG\") {\n        console.log(\"attack\", keys);\n      }\n      player.current.attack(synthName, keys);\n    }\n  };\n\n  useEffect(() => {\n    const blurListener = () => {\n      if (player.current) {\n        setKeyState([...initialKeyState]);\n        player.current.releaseAll();\n      }\n    };\n\n    window.addEventListener(\"blur\", blurListener);\n    return () => {\n      window.removeEventListener(\"blur\", blurListener);\n    };\n  }, [player]);\n\n  return (\n    <div className=\"flex justify-center w-full p-4\">\n      {keyState.map((state, idx) => (\n        <Key\n          key={idx}\n          hightlight={false}\n          onAttack={() => {\n            if (!keyState[idx].pressed) {\n              const clone = [...keyState];\n              clone[idx] = { ...clone[idx], pressed: true };\n              setKeyState(clone);\n              playPressedNotes(clone);\n            }\n          }}\n          onRelease={() => {\n            if (keyState[idx].pressed) {\n              const clone = [...keyState];\n              clone[idx].pressed = false;\n              clone[idx] = { ...clone[idx], pressed: false };\n              setKeyState(clone);\n              if (process.env.NODE_ENV === \"DEBUG\") {\n                console.log(\"release\", [state.note]);\n              }\n              player.current.release(synthName, state.note);\n            }\n          }}\n          {...state}\n        />\n      ))}\n    </div>\n  );\n}\n","import React, { useState, useEffect, useCallback } from \"react\";\nimport Row from \"./Row\";\nimport Keyboard from \"./Keyboard\";\nimport { map } from \"lodash\";\n\nconst getEmptyRow = size => {\n  return [\n    new Array(size).fill(0).map(() => {\n      return { notes: [], synthName: null, clicked: false };\n    })\n  ];\n};\n\nexport default function Board(props) {\n  const { maxSize, synthName } = props;\n  const [board, setBoard] = useState(getEmptyRow(maxSize));\n  useEffect(() => {\n    const clear = () => {\n      const clone = map(board, row => {\n        return map(row, val => {\n          return { ...val, notes: [], clicked: false };\n        });\n      });\n      setBoard(clone);\n    };\n    const addRow = () => {\n      setBoard(board.concat(getEmptyRow(maxSize)));\n    };\n    props.emitter.addEventListener(\"clear\", clear);\n    props.emitter.addEventListener(\"addRow\", addRow);\n    return () => {\n      props.emitter.removeEventListener(\"clear\", clear);\n      props.emitter.removeEventListener(\"addRow\", addRow);\n    };\n  }, [props.emitter, props.size, board, maxSize]);\n\n  const lookForEvt = useCallback(\n    notes => {\n      board.forEach((row, rowIdx) => {\n        row.forEach((el, colIdx) => {\n          if (el.clicked && !el.notes.length) {\n            const clone = [...board];\n            clone[rowIdx][colIdx].notes = notes;\n            clone[rowIdx][colIdx].synthName = synthName;\n            setBoard(clone);\n          }\n        });\n      });\n    },\n    [board, synthName]\n  );\n\n  return (\n    <div>\n      <div className=\"flex  w-full\">\n        <div className=\"flex h-auto m-2 w-full flex-col\">\n          {board.map((rowData, rowIdx) => (\n            <Row\n              rowData={rowData}\n              maxSize={maxSize}\n              step={props.step}\n              key={rowIdx}\n              onClick={colIdx => {\n                const clone = [...board];\n                clone[rowIdx][colIdx].clicked = !clone[rowIdx][colIdx].clicked;\n                clone[rowIdx][colIdx].notes = [];\n                setBoard(clone);\n              }}\n              onDelete={() => {\n                const clone = [...board];\n                clone.splice(rowIdx, 1);\n                setBoard(clone);\n              }}\n            />\n          ))}\n        </div>\n      </div>\n      <div className=\"p-4 w-full justify-center\">\n        <Keyboard onClick={lookForEvt} synthName={synthName} />\n      </div>\n    </div>\n  );\n}\n","// `Math.scale` method implementation\n// from https://github.com/zloirock/core-js\nexport function scale(x, inLow, inHigh, outLow, outHigh) {\n  if (\n    arguments.length === 0 ||\n    /* eslint-disable */\n    x != x ||\n    inLow != inLow ||\n    inHigh != inHigh ||\n    outLow != outLow ||\n    outHigh != outHigh\n    /* eslint-enable */\n  )\n    return NaN;\n  if (x === Infinity || x === -Infinity) return x;\n  return ((x - inLow) * (outHigh - outLow)) / (inHigh - inLow) + outLow;\n}\n","import React, { useEffect, useCallback, useRef } from \"react\";\nimport { fft } from \"../utils/Player\";\nimport { scale } from \"../utils\";\nimport { clamp } from \"lodash\";\n\nexport default function FFT(props) {\n  const canvas = useRef();\n  const context = useRef();\n  const loop = useCallback(() => {\n    requestAnimationFrame(loop);\n    const value = fft.getValue();\n    const width = canvas.current.width;\n    const height = canvas.current.height;\n    context.current.clearRect(0, 0, width, height);\n    context.current.fillStyle = \"black\";\n    value.forEach((v, i) => {\n      const x = scale(i, 0, value.length, 0, width);\n      const barHeight = clamp(scale(v, -100, 0, 0, height), 0, height);\n      context.current.fillRect(x, height / 2 - barHeight / 2, 2, barHeight);\n      context.current.fill();\n    });\n    context.current.strokeStyle = \"white\";\n    context.current.stroke();\n  }, []);\n\n  useEffect(() => {\n    loop();\n  }, [loop]);\n\n  return (\n    <canvas\n      className=\"w-24 h-10 border-2 border-gray-600 rounded\"\n      ref={node => {\n        if (node !== null) {\n          canvas.current = node;\n          node.width = node.clientWidth * 2;\n          node.height = node.clientHeight * 2;\n          context.current = node.getContext(\"2d\");\n        }\n      }}\n    >\n      waveform of current playing audio\n    </canvas>\n  );\n}\n","import React, { useEffect, useCallback, useRef } from \"react\";\nimport { meter } from \"../utils/Player\";\nconst barHeight = 5;\nexport default function Meter(props) {\n  const canvas = useRef();\n  const context = useRef();\n  const loop = useCallback(() => {\n    requestAnimationFrame(loop);\n    const meterValue = meter.getValue();\n    const width = canvas.current.width;\n    const height = canvas.current.height;\n    if (meterValue >= 0) {\n      context.current.clearRect(0, 0, width, height);\n      context.current.fillStyle = \"black\";\n      const positionY = meterValue * height;\n      context.current.fillRect(\n        0,\n        height - positionY - barHeight,\n        width,\n        barHeight\n      );\n      context.current.fill();\n      if (meterValue > 0) {\n        context.current.fillStyle = \"gray\";\n        context.current.fillRect(0, height - positionY, width, height);\n        context.current.fill();\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    loop();\n  }, [loop]);\n\n  return (\n    <canvas\n      className=\"w-4 h-10 m-2 border-2 border-gray-600 rounded\"\n      ref={node => {\n        if (node !== null) {\n          canvas.current = node;\n          node.width = node.clientWidth * 2;\n          node.height = node.clientHeight * 2;\n          context.current = node.getContext(\"2d\");\n        }\n      }}\n    >\n      meter of current playing audio\n    </canvas>\n  );\n}\n","import React, { useState, useEffect, useRef } from \"react\";\nimport Board from \"./components/Board\";\nimport FFT from \"./components/FFT\";\nimport Meter from \"./components/Meter\";\nimport Dropdown from \"./components/Dropdown\";\nimport Player from \"./utils/Player\";\nimport { without } from \"lodash\";\nimport \"./styles/tailwind.css\";\nimport { maxTimeCount, synthOptions } from \"./constants\";\n\nconst initialStep = -1;\nconst maxSize = maxTimeCount;\nconst buttonClasses =\n  \"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded m-2\";\nfunction App() {\n  const [step, setStep] = useState(initialStep);\n  const [synthName, setSynthName] = useState(synthOptions[0]);\n  const stepContainer = useRef(step);\n  const callbackContainer = useRef({ clear: [], addRow: [] });\n  const loopPlayer = useRef();\n\n  const emitter = {\n    addEventListener: (event, fn) => {\n      if (!callbackContainer.current[event]) {\n        callbackContainer.current[event] = [];\n      }\n      callbackContainer.current[event].push(fn);\n    },\n    removeEventListener: (event, fn) => {\n      callbackContainer.current[event] = without(\n        callbackContainer.current[event],\n        fn\n      );\n    }\n  };\n\n  const tick = () => {\n    let newVal;\n    if (stepContainer.current + 1 < maxSize) {\n      newVal = stepContainer.current + 1;\n    } else {\n      newVal = 0;\n    }\n    stepContainer.current = newVal;\n    setStep(stepContainer.current);\n  };\n\n  useEffect(() => {\n    loopPlayer.current = new Player(1);\n    loopPlayer.current.createLoop(tick);\n  }, []);\n\n  return (\n    <div className=\"flex flex-col h-screen items-center justify-center bg-gray-200\">\n      <div className=\"flex items-center justify-between p-2\">\n        <Meter />\n        <FFT />\n        <Meter />\n      </div>\n      <div className=\"flex items-center justify-between p-2\">\n        <button\n          className={buttonClasses}\n          onClick={() => {\n            loopPlayer.current.constructor.startLoop();\n          }}\n        >\n          Start\n        </button>\n        <button\n          className={buttonClasses}\n          onClick={() => {\n            loopPlayer.current.stopLoop();\n\n            stepContainer.current = initialStep;\n            setStep(initialStep);\n          }}\n        >\n          Stop\n        </button>\n        <button\n          className={buttonClasses}\n          onClick={() => {\n            callbackContainer.current.clear.forEach(fn => fn());\n          }}\n        >\n          Clear\n        </button>\n        <button\n          className={buttonClasses}\n          onClick={() => {\n            callbackContainer.current.addRow.forEach(fn => fn());\n          }}\n        >\n          Add row\n        </button>\n        <Dropdown\n          options={synthOptions}\n          value={synthName}\n          onChange={val => {\n            setSynthName(val);\n          }}\n        />\n      </div>\n      <Board\n        maxSize={maxSize}\n        step={step}\n        emitter={emitter}\n        synthName={synthName}\n      />\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}